//Linha Modal 1.1
(function($){$.fn.modal=function(options){return new $.modal(options,this);};$.modal=function(options,elem){var padrao={seletor:'.modal',seletorImagem:'imagem',seletorAjax:'ajax',seletorIframe:'iframe',seletorVideo:'video',seletorCancela:'fecha',seletorConfirma:'confirma',classeModal:'modal-area',classeTitulo:'modal-titulo',classeConteudo:'modal-conteudo',classeFecha:'modal-fecha',classeLoad:'modal-load',classeFundo:'modal-fundo',fundoOpacidade:0.7,zIndex:1000,evento:'click',eventoFecha:'click',eventoFundo:'click',eventoConfirma:'click',eventoCancela:'click',tempo:'fast',tempoFundo:'fast',tempoLoad:'fast',fundo:true,fecha:true,titulo:null,conteudo:null,conteudoAntes:false,autoPosiciona:false,atributoLink:'href',atributoTitulo:'titulo',atributoConteudo:'conteudo',atributoAltura:'altura',atributoLargura:'largura',atributoIframeLargura:'iframelargura',atributoIframeAltura:'iframealtura',atributoVideoLargura:'videolargura',atributoVideoAltura:'videoaltura',onCria:null,onExibe:null,onFecha:null,onConfirma:null,onCancela:null};var o=$.extend(padrao,options),$d=$(document),$w=$(window),m=[],el=[],w=[],$t='';if(elem===undefined){elem=$(o.seletor);}
$d.delegate(elem.selector,o.evento,function(){if($('.'+o.classeModal).length){return false;}
$t=$(this);el.titulo=$t.attr(o.atributoTitulo);el.conteudo=$t.attr(o.atributoConteudo);el.altura=$t.attr(o.atributoAltura);el.largura=$t.attr(o.atributoLargura);el.link=$t.attr(o.atributoLink);el.iframeLargura=$t.attr(o.atributoIframeLargura);el.iframeAltura=$t.attr(o.atributoIframeAltura);el.videoLargura=$t.attr(o.atributoVideoLargura);el.videoAltura=$t.attr(o.atributoVideoAltura);criaModal();dataModal();return false;});function criaModal(){if(o.fundo){m.fundo=$('<div></div>').addClass(o.classeFundo).css({width:'100%',height:'100%',opacity:o.fundoOpacidade,position:'fixed',top:0,left:0,zIndex:o.zIndex-1,backgroundColor:'#000',display:'none'}).appendTo('body').fadeIn(o.tempoFundo);}
m.load=$('<div></div>').addClass(o.classeLoad).css({position:'fixed',top:'50%',left:'50%',zIndex:o.zIndex});m.modal=$('<div></div>').addClass(o.classeModal).css({width:el.largura,height:el.altura,position:'absolute',zIndex:o.zIndex,display:'none'});if(o.autoPosiciona){m.modal.css({position:'fixed',top:"50%",left:"50%"});}
m.fecha=$('<span>x</span>').addClass(o.classeFecha);if(o.classeTitulo!=null&&o.classeTitulo){m.titulo=$('<div></div>').addClass(o.classeTitulo);}
m.conteudo=$('<div></div>').addClass(o.classeConteudo);m.load.css({marginTop:-(m.load.outerHeight()/2),marginLeft:-(m.load.outerWidth()/2)});if($.isFunction(o.onCria)){o.onCria.apply(m.modal,new Array(m,el,$t,o));}}
function dataModal(){if(m.titulo)m.titulo.html(o.titulo).append(el.titulo);if($t.hasClass(o.seletorVideo)){el.link=el.link.replace(new RegExp("watch\\?v=","i"),'v/');var data='<object width="'+el.videoLargura+'" height="'+el.videoAltura+'" classid="clsid:D27CDB6E-AE6D-11CF-96B8-444553540000" codebase="http://fpdownload.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=8,0,0,0" style="display: block">';data+='<param name="movie" value="'+el.link+'"></param>';data+='<embed type="application/x-shockwave-flash" src="'+el.link+'" width="'+el.videoLargura+'" height="'+el.videoAltura+'"></embed>';data+='</object>';m.conteudo.append(data);}
else if($t.hasClass(o.seletorIframe)){var data='<iframe src="'+el.link+'" height="'+el.iframeAltura+'" width="'+el.iframeLargura+'" style="border:0; display: block" frameBorder="0"></iframe>';m.conteudo.append(data);}
else if($t.hasClass(o.seletorAjax)){m.load.appendTo('body');$.ajax({type:"POST",url:el.link,success:function(data){m.load.fadeOut(o.tempoFundo,function(){$(this).remove();});m.conteudo.append(data);return mostraModal();},error:function(){m.load.fadeOut(o.tempoFundo,function(){$(this).remove();});m.conteudo.append("Ocorreu algum erro ou esta url n√£o existel...");return mostraModal();}});return;}
else if($t.hasClass(o.seletorImagem)){m.load.appendTo('body');var img=new Image();$(img).load(function(){$(this).css({display:'none',height:this.height,width:this.width});m.load.fadeOut(o.tempoFundo,function(){$(this).remove();});m.conteudo.append(img);$(this).fadeIn();return redimensionaModal(this.width,this.height);}).attr('src',el.link);return;}
else{m.conteudo.append(el.conteudo);}
return mostraModal();}
function redimensionaModal(w,h){m.conteudo.css({height:h,width:w});mostraModal();}
function mostraModal(){if(!o.conteudoAntes){m.conteudo.append(o.conteudo);}else{m.conteudo.prepend(o.conteudo);}
if(m.titulo&&m.titulo.html()!==undefined){m.modal.append(m.titulo);}
m.modal.append(m.conteudo).append(m.fecha).appendTo('body').hide();if(o.autoPosiciona){m.modal.css({marginTop:-(m.modal.outerHeight()/2),marginLeft:-(m.modal.outerWidth()/2)});}else{w.w=$w.width();w.h=$w.height();w.sl=$w.scrollLeft();w.st=$w.scrollTop();var mTop=w.h/2+(w.st)-(m.modal.outerHeight()/2);var mLeft=(w.w/2)+w.sl-(m.modal.outerWidth()/2);m.modal.css({top:mTop,left:mLeft});}
m.modal.fadeIn(o.tempo);if(o.fecha&&m.fundo){m.fundo[o.eventoFundo](function(){return deletaModal();});}
m.fecha[o.eventoFecha](function(){return deletaModal();});$('.'+o.seletorCancela)[o.eventoCancela](function(){if($.isFunction(o.onCancela)){o.onCancela.apply(this,new Array(m,el,$t,o));}
return deletaModal();});$('.'+o.seletorConfirma)[o.eventoConfirma](function(){if($.isFunction(o.onConfirma)){o.onConfirma.apply(this,new Array(m,el,$t,o));}
return deletaModal();});if($.isFunction(o.onExibe)){o.onExibe.apply(m.modal,new Array(m,el,$t,o));}}
function deletaModal(){if(m.fundo){m.fundo.fadeOut(o.tempo,function(){$(this).remove();});}
if(m.load.length){m.load.remove();}
m.modal.remove();if($.isFunction(o.onFecha)){o.onFecha.apply(m.modal,new Array(m,el,$t,o));}
return false;}};})(jQuery);
